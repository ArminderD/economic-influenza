---
title: "draft-figs"
output: 
  html_document: 
    keep_md: yes
    self_contained: no
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
rm(list = ls(all.names = TRUE))
library(ggplot2)
library(tidyr)
```

```{r}
df <- read.csv("~/git/economic-influenza/df/icer-vaxbase-40.csv")
df$age <- factor(df$age, levels = c("0-4", "5-19", "20-64", "65+", "All"))
df$risk <- factor(df$risk, levels = c("High", "Non-high", "All"))

age_group_df <- df[1:12,]
risk_group_df <- df[(df$risk!="All"),]

```

```{r}
# cases, deaths, dalys
ggplot(risk_group_df, aes(x = age, y = cases, fill = risk)) + geom_bar(stat = "identity", position = "stack")
ggplot(risk_group_df, aes(x = age, y = deaths, fill = risk)) + geom_bar(stat = "identity", position = "stack")
ggplot(risk_group_df, aes(x = age, y = dalys, fill = risk)) + geom_bar(stat = "identity", position = "stack")

# per 100K
ggplot(df, aes(x = age, y = dalys.rate, fill = risk)) + geom_bar(stat = "identity", position = "dodge")
```

```{r}
# averted cases, deaths, dalys
ggplot(risk_group_df, aes(x = age, y = cases.averted, fill = risk)) + geom_bar(stat = "identity", position = "stack")
ggplot(risk_group_df, aes(x = age, y = deaths.averted, fill = risk)) + geom_bar(stat = "identity", position = "stack")
ggplot(risk_group_df, aes(x = age, y = dalys.averted, fill = risk)) + geom_bar(stat = "identity", position = "stack")

# per 100K
ggplot(df, aes(x = age, y = dalys.averted.rate, fill = risk)) + geom_bar(stat = "identity", position = "dodge")
```

```{r}
# ICERs
ggplot(df, aes(x = age, y = icer.case.averted, fill = risk)) + geom_bar(stat = "identity", position = "dodge")
ggplot(df, aes(x = age, y = icer.death.averted, fill = risk)) + geom_bar(stat = "identity", position = "dodge")
ggplot(df, aes(x = age, y = icer.daly.averted, fill = risk)) + geom_bar(stat = "identity", position = "dodge")

# line plot
ggplot(df, aes(x = age, y = icer.case.averted, color = risk, group = risk)) + geom_point() + geom_line(linetype = "dotted")
ggplot(df, aes(x = age, y = icer.death.averted, color = risk, group = risk)) + geom_point() + geom_line(linetype = "dotted")
ggplot(df, aes(x = age, y = icer.daly.averted, color = risk, group = risk)) + geom_point() + geom_line(linetype = "dotted")
```

```{r}
# violin plot

# scatter plot: dalys averted per 100K by cost difference
ggplot(df, aes(x = cost.diff, y = dalys.averted.rate, shape = risk, color = age)) + geom_point()
```
