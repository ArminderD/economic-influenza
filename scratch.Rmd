---
title: "scratch"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(mc2d)
rm(list = ls(all.names = TRUE))
```

```{r}
source("functions.R")
source("variables.R")
```

###### 0-4 years ######

```{r}
pop <- pop_04
num_cases <- base_04
cases_after_vax <- intv_04
vax_comp_i <- vc_04
```

## 0-4 years, HIGH RISK
```{r}
risk_group <- high_019
prob <- c(p_04_high_death, p_04_high_hosp, p_04_high_out, p_04_high_rest)
r_cost <- rc_04_high

# total vaccination cost for age/risk
total_cost_vax_b <- calc_vaccination_cost(pop, risk_group, vax_cost, vax_comp_b)  # base
total_cost_vax_i <- calc_vaccination_cost(pop, risk_group, vax_cost, vax_comp_i)  # intv

# cost per health outcome
costs <- cost_cpi_outcome(r_cost[1], r_cost[2], r_cost[3], r_cost[4])

# age/risk group cases
b_cases <- calc_subpop_cases_base(num_cases, risk_group)  # base
i_cases <- calc_subpop_cases_intv(cases_after_vax, risk_group)  # intv

# cases averted
cases_averted <- b_cases - i_cases

# number of cases per outcome
(num_outcomes_base <- calc_num_outcomes_base(prob[1], prob[2], prob[3], prob[4]))  # base
(num_outcomes_intv <- calc_num_outcomes_intv(prob[1], prob[2], prob[3], prob[4]))  # intv

# total costs per health outcome
(cc_base <- calc_total_cost_base(r_cost[1],r_cost[2],r_cost[3],r_cost[4]))  # base
(cc_intv <- calc_total_cost_intv(r_cost[1],r_cost[2],r_cost[3],r_cost[4]))  # intv

# ICER table
total_cost_vax_b
total_cost_vax_i
cc_base[5]
cc_intv[5]
(net_costs_b = cc_base[5]+total_cost_vax_b)
(net_costs_i = cc_intv[5]+total_cost_vax_i)
(cost_diff = net_costs_b - net_costs_i)
b_cases
i_cases
cases_averted
cost_diff/cases_averted

(icer_04_high <- calc_icer())
```

## 0-4 years, low risk
```{r}
risk_group <- 1-high_019
prob <- c(p_04_low_death, p_04_low_hosp, p_04_low_out, p_04_low_rest)
r_cost <- rc_04_low

# total vaccination cost for age/risk
total_cost_vax_b <- calc_vaccination_cost(pop, risk_group, vax_cost, vax_comp_b)  # base
total_cost_vax_i <- calc_vaccination_cost(pop, risk_group, vax_cost, vax_comp_i)  # intv

# cost per health outcome
costs <- cost_cpi_outcome(r_cost[1], r_cost[2], r_cost[3], r_cost[4])

# age/risk group cases
b_cases <- calc_subpop_cases_base(num_cases, risk_group)  # base
i_cases <- calc_subpop_cases_intv(cases_after_vax, risk_group)  # intv

# cases averted
cases_averted <- b_cases - i_cases

# number of cases per outcome
(num_outcomes_base <- calc_num_outcomes_base(prob[1], prob[2], prob[3], prob[4]))  # base
(num_outcomes_intv <- calc_num_outcomes_intv(prob[1], prob[2], prob[3], prob[4]))  # intv

# total costs per health outcome
(cc_base <- calc_total_cost_base(r_cost[1],r_cost[2],r_cost[3],r_cost[4]))  # base
(cc_intv <- calc_total_cost_intv(r_cost[1],r_cost[2],r_cost[3],r_cost[4]))  # intv

# ICER table
total_cost_vax_b
total_cost_vax_i
cc_base[5]
cc_intv[5]
(net_costs_b = cc_base[5]+total_cost_vax_b)
(net_costs_i = cc_intv[5]+total_cost_vax_i)
(cost_diff = net_costs_b - net_costs_i)
b_cases
i_cases
cases_averted
cost_diff/cases_averted

(icer_04_low <- calc_icer())
```


###### 5-19 years ######

```{r}
pop <- pop_519
num_cases <- base_519
cases_after_vax <- intv_519
vax_comp_i <- vc_519
```

## 5-19 years, HIGH RISK
```{r}
risk_group <- high_019
prob <- c(p_519_high_death, p_519_high_hosp, p_519_high_out, p_519_high_rest)
r_cost <- rc_519_high

# total vaccination cost for age/risk
total_cost_vax_b <- calc_vaccination_cost(pop, risk_group, vax_cost, vax_comp_b)  # base
total_cost_vax_i <- calc_vaccination_cost(pop, risk_group, vax_cost, vax_comp_i)  # intv

# cost per health outcome
costs <- cost_cpi_outcome(r_cost[1], r_cost[2], r_cost[3], r_cost[4])

# age/risk group cases
b_cases <- calc_subpop_cases_base(num_cases, risk_group)  # base
i_cases <- calc_subpop_cases_intv(cases_after_vax, risk_group)  # intv

# cases averted
cases_averted <- b_cases - i_cases

# number of cases per outcome
(num_outcomes_base <- calc_num_outcomes_base(prob[1], prob[2], prob[3], prob[4]))  # base
(num_outcomes_intv <- calc_num_outcomes_intv(prob[1], prob[2], prob[3], prob[4]))  # intv

# total costs per health outcome
(cc_base <- calc_total_cost_base(r_cost[1],r_cost[2],r_cost[3],r_cost[4]))  # base
(cc_intv <- calc_total_cost_intv(r_cost[1],r_cost[2],r_cost[3],r_cost[4]))  # intv

# ICER table
total_cost_vax_b
total_cost_vax_i
cc_base[5]
cc_intv[5]
(net_costs_b = cc_base[5]+total_cost_vax_b)
(net_costs_i = cc_intv[5]+total_cost_vax_i)
(cost_diff = net_costs_b - net_costs_i)
b_cases
i_cases
cases_averted
cost_diff/cases_averted

(icer_519_high <- calc_icer())
```

## 5-19 years, low risk
```{r}
risk_group <- 1-high_019
prob <- c(p_519_low_death, p_519_low_hosp, p_519_low_out, p_519_low_rest)
r_cost <- rc_519_low

# total vaccination cost for age/risk
total_cost_vax_b <- calc_vaccination_cost(pop, risk_group, vax_cost, vax_comp_b)  # base
total_cost_vax_i <- calc_vaccination_cost(pop, risk_group, vax_cost, vax_comp_i)  # intv

# cost per health outcome
costs <- cost_cpi_outcome(r_cost[1], r_cost[2], r_cost[3], r_cost[4])

# age/risk group cases
b_cases <- calc_subpop_cases_base(num_cases, risk_group)  # base
i_cases <- calc_subpop_cases_intv(cases_after_vax, risk_group)  # intv

# cases averted
cases_averted <- b_cases - i_cases

# number of cases per outcome
(num_outcomes_base <- calc_num_outcomes_base(prob[1], prob[2], prob[3], prob[4]))  # base
(num_outcomes_intv <- calc_num_outcomes_intv(prob[1], prob[2], prob[3], prob[4]))  # intv

# total costs per health outcome
(cc_base <- calc_total_cost_base(r_cost[1],r_cost[2],r_cost[3],r_cost[4]))  # base
(cc_intv <- calc_total_cost_intv(r_cost[1],r_cost[2],r_cost[3],r_cost[4]))  # intv

# ICER table
total_cost_vax_b
total_cost_vax_i
cc_base[5]
cc_intv[5]
(net_costs_b = cc_base[5]+total_cost_vax_b)
(net_costs_i = cc_intv[5]+total_cost_vax_i)
(cost_diff = net_costs_b - net_costs_i)
b_cases
i_cases
cases_averted
cost_diff/cases_averted

(icer_519_low <- calc_icer())
```


###### 20-64 years ######

```{r}
pop <- pop_2064
num_cases <- base_2064
cases_after_vax <- intv_2064
vax_comp_i <- vc_2064
```

## 20-64 years, HIGH RISK
```{r}
risk_group <- high_2064
prob <- c(p_2064_high_death, p_2064_high_hosp, p_2064_high_out, p_2064_high_rest)
r_cost <- rc_2064_high

# total vaccination cost for age/risk
total_cost_vax_b <- calc_vaccination_cost(pop, risk_group, vax_cost, vax_comp_b)  # base
total_cost_vax_i <- calc_vaccination_cost(pop, risk_group, vax_cost, vax_comp_i)  # intv

# cost per health outcome
costs <- cost_cpi_outcome(r_cost[1], r_cost[2], r_cost[3], r_cost[4])

# age/risk group cases
b_cases <- calc_subpop_cases_base(num_cases, risk_group)  # base
i_cases <- calc_subpop_cases_intv(cases_after_vax, risk_group)  # intv

# cases averted
cases_averted <- b_cases - i_cases

# number of cases per outcome
(num_outcomes_base <- calc_num_outcomes_base(prob[1], prob[2], prob[3], prob[4]))  # base
(num_outcomes_intv <- calc_num_outcomes_intv(prob[1], prob[2], prob[3], prob[4]))  # intv

# total costs per health outcome
(cc_base <- calc_total_cost_base(r_cost[1],r_cost[2],r_cost[3],r_cost[4]))  # base
(cc_intv <- calc_total_cost_intv(r_cost[1],r_cost[2],r_cost[3],r_cost[4]))  # intv

# ICER table
total_cost_vax_b
total_cost_vax_i
cc_base[5]
cc_intv[5]
(net_costs_b = cc_base[5]+total_cost_vax_b)
(net_costs_i = cc_intv[5]+total_cost_vax_i)
(cost_diff = net_costs_b - net_costs_i)
b_cases
i_cases
cases_averted
cost_diff/cases_averted

(icer_2064_high <- calc_icer())
```

## 20-64 years, low risk
```{r}
risk_group <- 1-high_2064
prob <- c(p_2064_low_death, p_2064_low_hosp, p_2064_low_out, p_2064_low_rest)
r_cost <- rc_2064_low

# total vaccination cost for age/risk
total_cost_vax_b <- calc_vaccination_cost(pop, risk_group, vax_cost, vax_comp_b)  # base
total_cost_vax_i <- calc_vaccination_cost(pop, risk_group, vax_cost, vax_comp_i)  # intv

# cost per health outcome
costs <- cost_cpi_outcome(r_cost[1], r_cost[2], r_cost[3], r_cost[4])

# age/risk group cases
b_cases <- calc_subpop_cases_base(num_cases, risk_group)  # base
i_cases <- calc_subpop_cases_intv(cases_after_vax, risk_group)  # intv

# cases averted
cases_averted <- b_cases - i_cases

# number of cases per outcome
(num_outcomes_base <- calc_num_outcomes_base(prob[1], prob[2], prob[3], prob[4]))  # base
(num_outcomes_intv <- calc_num_outcomes_intv(prob[1], prob[2], prob[3], prob[4]))  # intv

# total costs per health outcome
(cc_base <- calc_total_cost_base(r_cost[1],r_cost[2],r_cost[3],r_cost[4]))  # base
(cc_intv <- calc_total_cost_intv(r_cost[1],r_cost[2],r_cost[3],r_cost[4]))  # intv

# ICER table
total_cost_vax_b
total_cost_vax_i
cc_base[5]
cc_intv[5]
(net_costs_b = cc_base[5]+total_cost_vax_b)
(net_costs_i = cc_intv[5]+total_cost_vax_i)
(cost_diff = net_costs_b - net_costs_i)
b_cases
i_cases
cases_averted
cost_diff/cases_averted

(icer_2064_low <- calc_icer())
```


###### 65+ years ######

```{r}
pop <- pop_65
num_cases <- base_65
cases_after_vax <- intv_65
vax_comp_i <- vc_65
```

## 65+ years, HIGH RISK
```{r}
risk_group <- high_65
prob <- c(p_65_high_death, p_65_high_hosp, p_65_high_out, p_65_high_rest)
r_cost <- rc_65_high

# total vaccination cost for age/risk
total_cost_vax_b <- calc_vaccination_cost(pop, risk_group, vax_cost, vax_comp_b)  # base
total_cost_vax_i <- calc_vaccination_cost(pop, risk_group, vax_cost, vax_comp_i)  # intv

# cost per health outcome
costs <- cost_cpi_outcome(r_cost[1], r_cost[2], r_cost[3], r_cost[4])

# age/risk group cases
b_cases <- calc_subpop_cases_base(num_cases, risk_group)  # base
i_cases <- calc_subpop_cases_intv(cases_after_vax, risk_group)  # intv

# cases averted
cases_averted <- b_cases - i_cases

# number of cases per outcome
(num_outcomes_base <- calc_num_outcomes_base(prob[1], prob[2], prob[3], prob[4]))  # base
(num_outcomes_intv <- calc_num_outcomes_intv(prob[1], prob[2], prob[3], prob[4]))  # intv

# total costs per health outcome
(cc_base <- calc_total_cost_base(r_cost[1],r_cost[2],r_cost[3],r_cost[4]))  # base
(cc_intv <- calc_total_cost_intv(r_cost[1],r_cost[2],r_cost[3],r_cost[4]))  # intv

# ICER table
total_cost_vax_b
total_cost_vax_i
cc_base[5]
cc_intv[5]
(net_costs_b = cc_base[5]+total_cost_vax_b)
(net_costs_i = cc_intv[5]+total_cost_vax_i)
(cost_diff = net_costs_b - net_costs_i)
b_cases
i_cases
cases_averted
cost_diff/cases_averted

(icer_65_high <- calc_icer())
```

## 65+ years, low risk
```{r}
risk_group <- 1-high_65
prob <- c(p_65_low_death, p_65_low_hosp, p_65_low_out, p_65_low_rest)
r_cost <- rc_65_low

# total vaccination cost for age/risk
total_cost_vax_b <- calc_vaccination_cost(pop, risk_group, vax_cost, vax_comp_b)  # base
total_cost_vax_i <- calc_vaccination_cost(pop, risk_group, vax_cost, vax_comp_i)  # intv

# cost per health outcome
costs <- cost_cpi_outcome(r_cost[1], r_cost[2], r_cost[3], r_cost[4])

# age/risk group cases
b_cases <- calc_subpop_cases_base(num_cases, risk_group)  # base
i_cases <- calc_subpop_cases_intv(cases_after_vax, risk_group)  # intv

# cases averted
cases_averted <- b_cases - i_cases

# number of cases per outcome
(num_outcomes_base <- calc_num_outcomes_base(prob[1], prob[2], prob[3], prob[4]))  # base
(num_outcomes_intv <- calc_num_outcomes_intv(prob[1], prob[2], prob[3], prob[4]))  # intv

# total costs per health outcome
(cc_base <- calc_total_cost_base(r_cost[1],r_cost[2],r_cost[3],r_cost[4]))  # base
(cc_intv <- calc_total_cost_intv(r_cost[1],r_cost[2],r_cost[3],r_cost[4]))  # intv

# ICER table
total_cost_vax_b
total_cost_vax_i
cc_base[5]
cc_intv[5]
(net_costs_b = cc_base[5]+total_cost_vax_b)
(net_costs_i = cc_intv[5]+total_cost_vax_i)
(cost_diff = net_costs_b - net_costs_i)
b_cases
i_cases
cases_averted
cost_diff/cases_averted

(icer_65_low <- calc_icer())
```


